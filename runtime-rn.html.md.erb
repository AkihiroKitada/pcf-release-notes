---
title: Pivotal Elastic Runtime v1.8.0 Release Notes
owner: Release Engineering
---

## <a id='versions'></a> Cloud Foundry Versions

Versions 1.8.0 and higher versions of Elastic Runtime consist of these Cloud Foundry versions:

- CF Release version: 239
- Diego version: 0.1482.0
- Garden version: 0.342
- CF MySQL version: 26
- etcd version: 60
- Apps Manager release version: 642
- UAA version: 3.4.2 -> 3.6.1 as of v1.8.4
- Consul version: 108
- CF Routing release: 0.135
- PCF Service Backup release: 14
- PCF MySQL Backup release: 1.25
- Pivotal Account app: 1
- PCF Autoscale: 34
- PCF Notifications: 24
- cflinuxfs2-rootfs: 1.20 (the rootfs is updated frequently, so see the patch release notes below to view what version was used in each)
- Binary Buildpack: 1.0.2
- Go Buildpack: 1.7.10
- Java Buildpack: 3.8.1
- NodeJS Buildpack: 1.5.15
- PHP Buildpack: 4.3.14
- Python Buildpack: 1.5.7 (now includes Conda package manager)
- Ruby Buildpack: 1.6.19
- Staticfile Buildpack: 1.3.9

## Patches:

## 1.8.6

Adds the ability to perform an HTTP health check against the router VMs. This health-check endpoint is located at port `8080` on the `/health` path.

Fixes an issue with running Windows apps in Diego.

Relaxes the minimum upgrade version back to 1.7.20. This was conservatively raised to 1.7.21, but it was found to be unnecessarily restrictive.

Includes a patch that fixes the default value for the WebDAV network. This value was previously misconfigured with an incorrect network range.
The result of deploying with this misconfiguration could result in a failed deployment depending upon what network ranges your deployment uses.
After redeploying with this corrected default, if you find that the smoke tests fail with an error message indicating missing buildpacks, manually rolling the `cloud_controller` VMs should resolve the issue.

## 1.8.5

Adds the ability to use Google Cloud Storage for your File Storage configuration.

Adds an HTTP frontend healthcheck to the HAProxy job, at the /health endpoint.

Fixes a bug where the apps-usage service could lose database connectivity while the internal mysql proxies were being deployed.
This only affects deployments using internal mysql as a database.

Additionally, this release changes the route for the switchboard UI for the internal mysql proxies.
Previously, those dashboards were located at `proxy-X-p-mysql.internal.SYSTEM_DOMAIN`.
Now they can be found at `proxy-X-p-mysql-ert.SYSTEM_DOMAIN`.
This should remove the need to include an extra SAN entry in the TLS certificates for the platform.

## 1.8.4

Bumps UAA to version 3.6.1 to make upgrades possible from Elastic Runtime versions 1.7.24 and greater.

Also introduces a field in the Advanced Features section which allows you to add any networks that need access to the internal file storage of Elastic Runtime (WebDAV server). The default whitelist includes all RFC 1918 private IP ranges, so if your Elastic Runtime deployment is not using an RFC 1918 network for its private network, then you must add your network to this list. Otherwise, you do not need to do anything here.

## 1.8.3

Note: Do not upgrade to this version if you are starting with 1.7.20, or any version between 1.7.23 and 1.8.0 (non-inclusive).

Patches USN-3087-1, USN-3087-2, CVE-2016-6662, USN-3040-1, and USN-2953-1. Additional info can be found at https://pivotal.io/security. 

## 1.8.2

Note: Do not upgrade to this version if you are starting with 1.7.20, or any version between 1.7.23 and 1.8.0 (non-inclusive).

Fixes an issue where having SSL validation enabled while using the internal file storage in Elastic Runtime was preventing successful retrieval of files.

## 1.8.1

Note: Do not upgrade to this version if you are starting with 1.7.20, or any version between 1.7.23 and 1.8.0 (non-inclusive).

Patches CVE-2016-6651. Additional info can be found at https://pivotal.io/security.

## <a id="upgrade"></a>How to Upgrade

The procedure for upgrading to Pivotal Cloud Foundry Elastic Runtime v1.8 is documented in the [Upgrading Pivotal Cloud Foundry](../../customizing/upgrading-pcf.html) topic. When upgrading to v1.8, be aware of the following upgrade considerations:

* Before upgrading to PCF v1.8, remove any product tiles that are no longer supported in PCF. See [Review and Remove Unsupported Products](../../customizing/upgrading-pcf.html#remove-products).

* After you upgrade to Ops Manager v1.8, you must immediately upgrade to Elastic Runtime v1.8. In addition some product tiles must be upgraded in lockstep with the Elastic Runtime tile. If you are a customer upgrading from PCF 1.7 to PCF 1.8 and are using any of products listed in [Upgrade Elastic Runtime and Product Tiles](../../customizing/upgrading-pcf.html#upgrade_products), you must upgrade to the specified tile version when you upgrade the Elastic Runtime tile to v1.8.
 
* Some partner service tiles may currently be incompatible with PCF v1.8. Pivotal is working with partners to ensure their tiles are being updated to work with the latest versions of PCF. For information about which partner service releases are currently compatible with PCF v1.8, review the appropriate partners services release documentation at [http://docs.pivotal.io](http://docs.pivotal.io), or contact the partner organization that produces the tile. 

## <a id='versions'></a> New Features in Elastic Runtime v1.8.0 

### <a id='routing'></a> Routing

- TCP Routing enables developers to run apps on PCF that support non-HTTP TCP protocols. See the [HTTP vs TCP Routes](../../devguide/deploy-apps/routes-domains.html#http-vs-tcp-routes) topic for more information.
   - To support this, routing components fetch tokens from UAA by calling that component directly over TLS. The cert hosted by UAA is generated by Operations Manager.
- Some processes on the Gorouter job no longer run as root.
- Route services whose domain names are resolved using EDNS0 are now supported.


### <a id='authen'></a> Authentication and Authorization

- Apps Manager now supports inviting external users from LDAP & SAML user stores. See the [Adding Existing SAML or LDAP Users to a Pivotal Cloud Foundry Deployment](../../opsguide/external-user-management.html) topic for more information. 

- PCF Admin role can now be derived from SAML group memberships. See the [Grant Admin Permissions to an External Group (SAML or LDAP)](../../adminguide/uaa-user-management.html#external-group) topic for more information.

- Basic User Attributes including Email, First Name, and Last Name can now be derived from the the SAML or LDAP enabled external user store. See the [Retrieve User Email Addresses](../../adminguide/uaa-user-management.html#retrieving-email-addresses) topic for more information.

- The Login prompts displayed on the Login Page and in the CF CLI can now be configured. See the [Configuring Authentication and Enterprise SSO for Elastic Runtime](../../opsguide/auth-sso.html) topic for more information.

- New API Docs for UAA are now available at [http://docs.cloudfoundry.org/api/uaa/](http://docs.cloudfoundry.org/api/uaa/).

### <a id='docker'></a> Docker Proxy Server

This feature allows you to put a proxy server between your PCF deployment and Docker Hub for access to image files.

See the [Set Proxies for Docker Trusted Registries](../../opsguide/docker-registry.html#proxy) topic for more information.

### <a id='pivotalaccount'></a> Pivotal Account User Management Tool

Pivotal Account is a user management tool that allows users to create and manage their accounts. With Pivotal Account users can access apps assigned to their accounts as well as manage their apps. See the [Enabling Pivotal Account](../../opsguide/pivotal-account.html) topic for more information. 

### <a id='appcontainers'></a> Unprivileged App Containers

You can now switch off privileged containers for your apps.

See the [Understanding Container Security](../../concepts/container-security.html) topic for more information.

### <a id='sses3'></a> AWS SSE-S3

External file storage existing as blobstores for Cloud Controller can now be encrypted at rest using SSE-S3 on any IAAS supported by PCF. Existing blobs are not encrypted.

For example, see the [Configure File Storage](../../customizing/config-er-vmware.html#filestore-config) topic for more information on configuring SSE-S3 for VSphere.

### <a id='webdav'></a> NFS Migration to WebDAV

The internal file storage provisioned by Cloud Foundry for Cloud Controller files has been switched from an NFS server to the WebDAV protocol. There is no actual data migration as part of this switch. The protocol changes on the file server. When you upgrade to Elastic Runtime v1.8.0 or later, you are automatically switched over.

See this [Knowledge Base article](https://discuss.zendesk.com/hc/en-us/articles/217982188-How-to-use-Elastic-Runtime-blob-storage-data-) for more information about file storage. 

### <a id='sshproxy'></a> Configurable SSH Proxy for Diego Containers

As of PCF v1.8.0, you can specify static IP addresses for the Diego Brain job, which allows you to configure a load balancer to forward SSH traffic over port 2222 to these SSH proxy IPs. Configuring a load balancer for Diego Brain IP addresses allows SSH access to app containers.

For example, see the [Configure Networking](../../customizing/cloudform-er-config.html#networking) topic for more information.

### <a id='consoledeprecation'></a> Console Database Removed

With the introduction of a new Apps Manager app written in Javascript, there is no longer a need for a backend to this app. Therefore, the Apps Manager database (`console`) is no longer required by the Elastic Runtime tile. After a successful upgrade to PCF v1.8. you can safely scale the Apps Manager database (postgres) job to `0` in the **Resource Config** page of the Elastic Runtime tile. However, if you selected MySQL as the backend database for `console` during initial Elastic Runtime deployment, you can drop this database from the MySQL server yourself. If you keep the database, you no longer need to backup and restore it.

### <a id='collectordeprecate'></a> Collector Deprecation

As of PCF v1.8.0, the Collector job on Elastic Runtime is deprecated and no longer used by any PCF services. If you are upgrading to PCF v1.8.0 from PCF v1.6.x (via the PCF v1.7.x upgrade path) and previously used the Collector job to obtain log data from legacy DEA-based applications, you can safely scale the job down to zero instances after upgrading to both JMX Bridge (Ops Metrics v1.7.0) and PCF ERT v1.7.0 or higher.

### <a id='apivisible'></a> API Environment Variable Visibility

Similar to `space_developer_env_var_visibility`, the new feature flag `env_var_visibility` can be disabled to deny access to `/v2/apps/:guid/env` for all users, including administrators. 

See the [Feature Flags](../../adminguide/listing-feature-flags.html#flags) topic for more information.

### <a id='servicebrokerenhance'></a> Service Broker Improvements

Service brokers can respond with an `operation` string in the body of responses for asynchronous operations. This string will be returned to the broker when the Cloud Controller polls for the state of asynchronous operations (see below). For more information, see the response body for [Provisioning](../../services/api-v2.9.html#provisioning), [Deprovisioning](../../services/api-v2.9.html#deprovisioning), and [Updating](../../services/api-v2.9.html#updating_service_instance).

Service brokers will now receive `service_id`, `plan_id`, and `operation` when polled for last operation state by the Cloud Controller. These extra query parameters can be used by brokers to help determine the state of the last operation. See [Polling Last Operation](../../services/api-v2.9.html#polling) for more information.

### <a id='cli_v3_support'></a> Cloud Foundry CLI v3 Plugin

This release of Elastic Runtime includes the Cloud Foundry CLI v3 plugin, which works with the Cloud Controller API v3. The CLI v3 plugin is useful for experimenting with the Cloud Controller v3 API without having to curl an oauth token. The Cloud Controller v3 API is under active development and is currently experimental. For more information on how to install and use the plugin, see the [CLI Plugin v3 README](https://github.com/cloudfoundry/v3-cli-plugin).

## <a id='knownissues'></a> Known Issues

This section lists new and existing known issues for Elastic Runtime.

### <a id='newissues'></a> New Issues

* Do not upgrade to versions 1.8.0 - 1.8.3 if you are starting with 1.7.20, or any 1.7.x version greater than 1.7.23.

* In Elastic Runtime 1.8.0 - 1.8.2, if you are using a non-RFC 1918 network as your private network for the deployment and internal file storage for Cloud Controller, then you will not be able to push apps to the system. 1.8.3 will address this issue by allowing you to specify a non-RFC 1918 network that you want to use.

* In Elastic Runtime 1.8.0 and 1.8.1, if you are using the internal file storage for Cloud Controller and you have the "Disable SSL certificate verification for this environment" checkbox unchecked, you will not be able to push apps to the system. 1.8.2 addresses this issue.

* If you choose to enable TCP routing, the reservable port range cannot be modified after deployment. This will be made possible in the next patch release.

* If you choose to enable TCP routing, you must also add the TCP routing domain via the cf CLI after deploying Elastic Runtime. The TCP routing domain is not configurable in the Elastic Runtime tile.

* If you choose to enable TCP routing, do not remove etcd data stores during failure recovery procedures since router group data added by the routing API is not ephemeral.

### <a id='existingissues'></a> Existing Issues

* The version of the PHP Buildpack included with 1.8.0 is vulnerable to multiple CVEs [[1](https://pivotal.io/security/cve-2016-6639)] [[2](https://pivotal.io/security/usn-3045-1)]. To mitigate these issues, update the PHP buildpack to the newest version as part of the 1.8.0 upgrade or new installation.

* Consul server cluster can fail to recover from quorum loss. See the [Consul fails to start during upgrade in PCF](https://discuss.pivotal.io/hc/en-us/articles/218196687-Consul-fails-to-start-during-upgrade-in-PCF) knowledge base article for how to recover from this issue.

* etcd and Consul clusters do not self-heal in cases where they happen to enter split-brain. 
* Disaster recovery for etcd or Consul clusters still requires manual intervention.

* The Cloud Foundry CLI command for viewing application files, `cf files`, does not work with apps on Diego.

* .NET support on Windows cells does not support the same level of security and isolation as seen on Linux cells. At this time, it is only recommended for running "trusted" apps.

* At this time, the container accounts on Windows cells must have permissions to log on locally, which may not be the default.

* Application file names on Windows cells are limited to maximum length of 100 characters. As a workaround, make sure that all filenames in an application directory are shorter than 100 characters before pushing.
